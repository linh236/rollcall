{"ast":null,"code":"$(document).ready(function () {\n  var lat = '';\n  var lon = '';\n\n  function geoFindMe() {\n    function success(position) {\n      var latitude = position.coords.latitude;\n      var longitude = position.coords.longitude;\n      lat = \"\".concat(latitude);\n      lon = \"\".concat(longitude); // $(\"#lat\").html(`${latitude}`);\n      // $(\"#lon\").html(`${longitude}`);\n    }\n\n    function error() {\n      status.textContent = 'Unable to retrieve your location';\n    }\n\n    if (!navigator.geolocation) {\n      alert('Geolocation is not supported by your browser');\n    } else {\n      navigator.geolocation.getCurrentPosition(success, error);\n    }\n  }\n\n  $(\"#lat,#lon,#ip\").hide();\n  ip = $(\"#ip\").html();\n  $(\"#rollcall\").click(function () {\n    $.getJSON('https://json.geoiplookup.io/api?callback=?', function (data) {\n      console.log(JSON.stringify(data, null, 2));\n    });\n    rollcallData = {\n      place: {\n        lat: lat,\n        lon: lon,\n        ip: ip\n      }\n    };\n    console.log(rollcallData);\n\n    if (lat == '' && lon == '') {\n      $.confirm({\n        title: false,\n        offsetTop: 20,\n        columnClass: \"col-md-6 col-md-offset-3 popup-rollcall\",\n        content: 'You should turn on GPS!',\n        closeIcon: true,\n        buttons: {\n          Cancel: {\n            btnClass: \"btn-red\",\n            action: function action() {\n              alert('Roll call failed !');\n            }\n          },\n          Confirm: {\n            btnClass: \"btn-blue\",\n            action: function action() {\n              geoFindMe();\n              alert('Turn on GPS success. Please Roll call again !');\n            }\n          }\n        }\n      });\n    } else {\n      return $.ajax({\n        type: \"POST\",\n        url: \"/places\",\n        data: rollcallData\n      }).done(function (response) {\n        alert(\"Roll call susccess.\");\n        location.reload();\n      }).fail(function (response) {});\n    }\n  });\n});","map":{"version":3,"sources":["/home/lihn/rollcall/app/javascript/packs/places.js"],"names":["$","document","ready","lat","lon","geoFindMe","success","position","latitude","coords","longitude","error","status","textContent","navigator","geolocation","alert","getCurrentPosition","hide","ip","html","click","getJSON","data","console","log","JSON","stringify","rollcallData","place","confirm","title","offsetTop","columnClass","content","closeIcon","buttons","Cancel","btnClass","action","Confirm","ajax","type","url","done","response","location","reload","fail"],"mappings":"AAAAA,CAAC,CAACC,QAAD,CAAD,CAAYC,KAAZ,CAAkB,YAAU;AAC1B,MAAIC,GAAG,GAAG,EAAV;AACA,MAAIC,GAAG,GAAG,EAAV;;AAEA,WAASC,SAAT,GAAqB;AACnB,aAASC,OAAT,CAAiBC,QAAjB,EAA2B;AACzB,UAAMC,QAAQ,GAAID,QAAQ,CAACE,MAAT,CAAgBD,QAAlC;AACA,UAAME,SAAS,GAAGH,QAAQ,CAACE,MAAT,CAAgBC,SAAlC;AACAP,MAAAA,GAAG,aAAMK,QAAN,CAAH;AACAJ,MAAAA,GAAG,aAAMM,SAAN,CAAH,CAJyB,CAKzB;AACA;AACD;;AACD,aAASC,KAAT,GAAiB;AACfC,MAAAA,MAAM,CAACC,WAAP,GAAqB,kCAArB;AACD;;AACD,QAAI,CAACC,SAAS,CAACC,WAAf,EAA4B;AAC1BC,MAAAA,KAAK,CAAC,8CAAD,CAAL;AACD,KAFD,MAEO;AACLF,MAAAA,SAAS,CAACC,WAAV,CAAsBE,kBAAtB,CAAyCX,OAAzC,EAAkDK,KAAlD;AACD;AACF;;AACDX,EAAAA,CAAC,CAAC,eAAD,CAAD,CAAmBkB,IAAnB;AACAC,EAAAA,EAAE,GAAGnB,CAAC,CAAC,KAAD,CAAD,CAASoB,IAAT,EAAL;AACApB,EAAAA,CAAC,CAAC,WAAD,CAAD,CAAeqB,KAAf,CAAqB,YAAU;AAC7BrB,IAAAA,CAAC,CAACsB,OAAF,CAAU,4CAAV,EAAwD,UAASC,IAAT,EAAe;AACvEC,MAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,SAAL,CAAeJ,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAZ;AACD,KAFC;AAGAK,IAAAA,YAAY,GAAG;AACbC,MAAAA,KAAK,EAAC;AACJ1B,QAAAA,GAAG,EAAEA,GADD;AAEJC,QAAAA,GAAG,EAAEA,GAFD;AAGJe,QAAAA,EAAE,EAAEA;AAHA;AADO,KAAf;AAOAK,IAAAA,OAAO,CAACC,GAAR,CAAYG,YAAZ;;AACA,QAAIzB,GAAG,IAAI,EAAP,IAAYC,GAAG,IAAI,EAAvB,EAA0B;AACtBJ,MAAAA,CAAC,CAAC8B,OAAF,CAAU;AACVC,QAAAA,KAAK,EAAE,KADG;AAEVC,QAAAA,SAAS,EAAE,EAFD;AAGVC,QAAAA,WAAW,EAAE,yCAHH;AAIVC,QAAAA,OAAO,EAAE,yBAJC;AAKVC,QAAAA,SAAS,EAAE,IALD;AAMVC,QAAAA,OAAO,EAAE;AACPC,UAAAA,MAAM,EAAC;AACLC,YAAAA,QAAQ,EAAE,SADL;AAELC,YAAAA,MAAM,EAAE,kBAAU;AAChBvB,cAAAA,KAAK,CAAC,oBAAD,CAAL;AACD;AAJI,WADA;AAOPwB,UAAAA,OAAO,EAAE;AACPF,YAAAA,QAAQ,EAAE,UADH;AAEPC,YAAAA,MAAM,EAAE,kBAAU;AAChBlC,cAAAA,SAAS;AACTW,cAAAA,KAAK,CAAC,+CAAD,CAAL;AACD;AALM;AAPF;AANC,OAAV;AAsBH,KAvBD,MAuBK;AACH,aAAOhB,CAAC,CAACyC,IAAF,CAAO;AACZC,QAAAA,IAAI,EAAE,MADM;AAEZC,QAAAA,GAAG,EAAE,SAFO;AAGZpB,QAAAA,IAAI,EAAEK;AAHM,OAAP,EAIJgB,IAJI,CAIC,UAAUC,QAAV,EAAoB;AAC1B7B,QAAAA,KAAK,CAAC,qBAAD,CAAL;AACA8B,QAAAA,QAAQ,CAACC,MAAT;AACD,OAPM,EAOJC,IAPI,CAOC,UAASH,QAAT,EAAkB,CACzB,CARM,CAAP;AASD;AACF,GA9CD;AA+CD,CAvED","sourcesContent":["$(document).ready(function(){\n  var lat = '';\n  var lon = '';\n\n  function geoFindMe() {\n    function success(position) {\n      const latitude  = position.coords.latitude;\n      const longitude = position.coords.longitude;\n      lat = `${latitude}`;\n      lon = `${longitude}`;\n      // $(\"#lat\").html(`${latitude}`);\n      // $(\"#lon\").html(`${longitude}`);\n    }\n    function error() {\n      status.textContent = 'Unable to retrieve your location';\n    }\n    if (!navigator.geolocation) {\n      alert('Geolocation is not supported by your browser');\n    } else {\n      navigator.geolocation.getCurrentPosition(success, error);\n    }\n  }\n  $(\"#lat,#lon,#ip\").hide();\n  ip = $(\"#ip\").html();\n  $(\"#rollcall\").click(function(){\n    $.getJSON('https://json.geoiplookup.io/api?callback=?', function(data) {\n    console.log(JSON.stringify(data, null, 2));\n  });\n    rollcallData = {\n      place:{\n        lat: lat,\n        lon: lon,\n        ip: ip\n      }\n    };\n    console.log(rollcallData);\n    if (lat == ''&& lon == ''){\n        $.confirm({\n        title: false,\n        offsetTop: 20,\n        columnClass: \"col-md-6 col-md-offset-3 popup-rollcall\",\n        content: 'You should turn on GPS!',\n        closeIcon: true,\n        buttons: {\n          Cancel:{\n            btnClass: \"btn-red\",\n            action: function(){\n              alert('Roll call failed !')\n            }\n          },\n          Confirm: {\n            btnClass: \"btn-blue\",\n            action: function(){\n              geoFindMe();\n              alert('Turn on GPS success. Please Roll call again !')\n            }\n          },\n        }\n      });\n    }else{\n      return $.ajax({\n        type: \"POST\",\n        url: \"/places\",\n        data: rollcallData,\n      }).done(function (response) {\n        alert(\"Roll call susccess.\");\n        location.reload();\n      }).fail(function(response){\n      });\n    }\n  })\n});\n"]},"metadata":{},"sourceType":"module"}