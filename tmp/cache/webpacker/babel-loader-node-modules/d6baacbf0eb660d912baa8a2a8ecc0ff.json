{"ast":null,"code":"$(document).ready(function () {\n  // var myVar = setInterval(myTimer, 1000);\n  var my = setInterval(autoload, 1000);\n\n  function autoload() {\n    $.each(gon.equipment, function (index, value) {\n      turnoff(value[\"timer\"], value[\"timeout\"], value[\"id\"]);\n    });\n  }\n\n  function turnoff(timer, timeout, id) {\n    var d = new Date();\n    var day = Date.parse(d);\n    var timer = Date.parse(timer);\n    var timeout = Date.parse(timeout);\n\n    if (day == timer) {\n      autoRequestTurnOn(id);\n    }\n\n    if (day == timeout) {\n      autoRequestTurnOff(id);\n    }\n  }\n\n  $('.timer,.timeout').css('cursor', 'pointer');\n  $('.turn').click(function () {\n    var id = $(this).data(\"id\");\n    var active = $(this).text();\n\n    if (active == \"On\") {\n      dataEquipment = {\n        equipment: {\n          active: false\n        }\n      };\n    } else {\n      dataEquipment = {\n        equipment: {\n          active: true\n        }\n      };\n    }\n\n    $.ajax({\n      type: 'PATCH',\n      url: \"/equipment/\" + id,\n      data: dataEquipment,\n      success: function success(repsonse) {\n        if (active == \"On\") {\n          console.log(\"Turn off is successfully.\");\n        } else {\n          console.log(\"Turn on is successfully.\");\n        }\n      },\n      error: function error(repsonse) {\n        console.log(\"Turn on is fails.\");\n      }\n    });\n  });\n  $('.timer').click(function () {\n    var id = $(this).data(\"id\");\n    var content = '';\n\n    if (id == 1) {\n      content = \"Đèn 13\";\n    } else if (id == 2) {\n      content = \"Đèn 14\";\n    } else {\n      content = \"Đèn 15\";\n    }\n\n    $.confirm({\n      title: content,\n      columnClass: 'col-md-5 col-md-offset-4',\n      content: '' + \"<form action='' class='formName'>\" + '<div class=\"form-group\">' + '<input type=\"datetime-local\" class=\"timer form-control\" required />' + '</div>' + '</form>',\n      buttons: {\n        formSubmit: {\n          text: 'Submit',\n          btnClass: 'btn-blue',\n          action: function action() {\n            var timer = this.$content.find('.timer').val();\n            $.ajax({\n              type: 'PATCH',\n              url: \"/equipment/\" + id,\n              data: {\n                equipment: {\n                  timer: timer\n                }\n              },\n              success: function success(repsonse) {\n                console.log(\"Set timer is successfully.\");\n              },\n              error: function error(repsonse) {\n                console.log(\"Set timer on is fails.\");\n              }\n            });\n          }\n        },\n        cancel: function cancel() {//close\n        }\n      },\n      onContentReady: function onContentReady() {\n        // bind to events\n        var jc = this;\n        this.$content.find('form').on('submit', function (e) {\n          // if the user submits the form by pressing enter in the field.\n          e.preventDefault();\n          jc.$$formSubmit.trigger('click'); // reference the button and click it\n        });\n      }\n    });\n  });\n  $('.timeout').click(function () {\n    var id = $(this).data(\"id\");\n    var content = '';\n\n    if (id == 1) {\n      content = \"Đèn 13\";\n    } else if (id == 2) {\n      content = \"Đèn 14\";\n    } else {\n      content = \"Đèn 15\";\n    }\n\n    $.confirm({\n      title: content,\n      columnClass: 'col-md-5 col-md-offset-4',\n      content: '' + \"<form action='' class='formName'>\" + '<div class=\"form-group\">' + '<input type=\"datetime-local\" class=\"timeout form-control\" required />' + '</div>' + '</form>',\n      buttons: {\n        formSubmit: {\n          text: 'Submit',\n          btnClass: 'btn-blue',\n          action: function action() {\n            var timeout = this.$content.find('.timeout').val();\n            $.ajax({\n              type: 'PATCH',\n              url: \"/equipment/\" + id,\n              data: {\n                equipment: {\n                  timeout: timeout\n                }\n              },\n              success: function success(repsonse) {\n                console.log(\"Set timer is successfully.\");\n              },\n              error: function error(repsonse) {\n                console.log(\"Set timer on is fails.\");\n              }\n            });\n          }\n        },\n        cancel: function cancel() {//close\n        }\n      },\n      onContentReady: function onContentReady() {\n        // bind to events\n        var jc = this;\n        this.$content.find('form').on('submit', function (e) {\n          // if the user submits the form by pressing enter in the field.\n          e.preventDefault();\n          jc.$$formSubmit.trigger('click'); // reference the button and click it\n        });\n      }\n    });\n  });\n\n  function autoRequestTurnOff(id) {\n    dataEquipment = {\n      equipment: {\n        active: false,\n        timeout: '00:00:0000 00:00'\n      }\n    };\n    $.ajax({\n      type: 'PATCH',\n      url: \"/equipment/\" + id,\n      data: dataEquipment,\n      success: function success(repsonse) {\n        console.log(\"Turn off is successfully.\");\n      },\n      error: function error(repsonse) {\n        console.log(\"Turn off is fails.\");\n      }\n    });\n  }\n\n  function autoRequestTurnOn(id) {\n    dataEquipment = {\n      equipment: {\n        active: true,\n        timer: '00:00:0000 00:00'\n      }\n    };\n    $.ajax({\n      type: 'PATCH',\n      url: \"/equipment/\" + id,\n      data: dataEquipment,\n      success: function success(repsonse) {\n        console.log(\"Turn off is successfully.\");\n      },\n      error: function error(repsonse) {\n        console.log(\"Turn off is fails.\");\n      }\n    });\n  }\n});","map":{"version":3,"sources":["/home/lihn/rollcall/app/javascript/packs/equipment.js"],"names":["$","document","ready","my","setInterval","autoload","each","gon","equipment","index","value","turnoff","timer","timeout","id","d","Date","day","parse","autoRequestTurnOn","autoRequestTurnOff","css","click","data","active","text","dataEquipment","ajax","type","url","success","repsonse","console","log","error","content","confirm","title","columnClass","buttons","formSubmit","btnClass","action","$content","find","val","cancel","onContentReady","jc","on","e","preventDefault","$$formSubmit","trigger"],"mappings":"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","sourcesContent":["$(document).ready(function(){\n  // var myVar = setInterval(myTimer, 1000);\n  var my = setInterval(autoload, 1000);\n\n  function autoload(){\n    $.each(gon.equipment, function( index, value ) {\n      turnoff(value[\"timer\"], value[\"timeout\"], value[\"id\"]);\n    });\n  }\n\n  function turnoff(timer, timeout, id){\n    var d = new Date();\n    var day = Date.parse(d);\n    var timer = Date.parse(timer);\n    var timeout = Date.parse(timeout);\n    if(day == timer){\n      autoRequestTurnOn(id);\n    }\n    if(day == timeout){\n      autoRequestTurnOff(id);\n    }\n\n  }\n\n  $('.timer,.timeout').css('cursor', 'pointer');\n  $('.turn').click(function(){\n    var id = $(this).data(\"id\");\n    var active = $(this).text();\n    if (active == \"On\"){\n      dataEquipment = {\n        equipment:{\n          active: false\n        }\n      }\n    }else{\n      dataEquipment = {\n        equipment:{\n          active: true\n        }\n      }\n    }\n    $.ajax({\n        type: 'PATCH',\n        url: \"/equipment/\"+id,\n        data: dataEquipment,\n        success: function(repsonse) {\n          if (active == \"On\"){\n            console.log(\"Turn off is successfully.\")\n          }else{\n            console.log(\"Turn on is successfully.\")\n          }\n        },\n        error: function(repsonse) {\n          console.log(\"Turn on is fails.\")\n        }\n    })\n\n  })\n  $('.timer').click(function(){\n    var id = $(this).data(\"id\");\n    var content = '';\n    if (id == 1){\n      content = \"Đèn 13\";\n    }else if (id == 2){\n      content = \"Đèn 14\";\n    }else{\n      content = \"Đèn 15\";\n    }\n    $.confirm({\n    title: content,\n    columnClass: 'col-md-5 col-md-offset-4',\n    content: '' +\n    \"<form action='' class='formName'>\" +\n    '<div class=\"form-group\">' +\n    '<input type=\"datetime-local\" class=\"timer form-control\" required />' +\n    '</div>' +\n    '</form>',\n    buttons: {\n        formSubmit: {\n          text: 'Submit',\n          btnClass: 'btn-blue',\n          action: function () {\n          var timer = this.$content.find('.timer').val();\n          $.ajax({\n              type: 'PATCH',\n              url: \"/equipment/\"+id,\n              data: {\n                equipment:{\n                  timer: timer\n                }\n              },\n              success: function(repsonse) {\n                console.log(\"Set timer is successfully.\")\n              },\n              error: function(repsonse) {\n                console.log(\"Set timer on is fails.\")\n              }\n            })\n          }\n        },\n        cancel: function () {\n            //close\n        },\n    },\n    onContentReady: function () {\n        // bind to events\n        var jc = this;\n        this.$content.find('form').on('submit', function (e) {\n            // if the user submits the form by pressing enter in the field.\n            e.preventDefault();\n            jc.$$formSubmit.trigger('click'); // reference the button and click it\n        });\n      }\n    });\n  })\n  $('.timeout').click(function(){\n    var id = $(this).data(\"id\");\n    var content = '';\n    if (id == 1){\n      content = \"Đèn 13\";\n    }else if (id == 2){\n      content = \"Đèn 14\";\n    }else{\n      content = \"Đèn 15\";\n    }\n    $.confirm({\n    title: content,\n    columnClass: 'col-md-5 col-md-offset-4',\n    content: '' +\n    \"<form action='' class='formName'>\" +\n    '<div class=\"form-group\">' +\n    '<input type=\"datetime-local\" class=\"timeout form-control\" required />' +\n    '</div>' +\n    '</form>',\n    buttons: {\n        formSubmit: {\n          text: 'Submit',\n          btnClass: 'btn-blue',\n          action: function () {\n          var timeout = this.$content.find('.timeout').val();\n          $.ajax({\n              type: 'PATCH',\n              url: \"/equipment/\"+id,\n              data: {\n                equipment:{\n                  timeout: timeout\n                }\n              },\n              success: function(repsonse) {\n                console.log(\"Set timer is successfully.\")\n              },\n              error: function(repsonse) {\n                console.log(\"Set timer on is fails.\")\n              }\n            })\n          }\n        },\n        cancel: function () {\n            //close\n        },\n    },\n    onContentReady: function () {\n        // bind to events\n        var jc = this;\n        this.$content.find('form').on('submit', function (e) {\n            // if the user submits the form by pressing enter in the field.\n            e.preventDefault();\n            jc.$$formSubmit.trigger('click'); // reference the button and click it\n        });\n      }\n    });\n  })\n\n  function autoRequestTurnOff(id){\n    dataEquipment = {\n      equipment:{\n        active: false,\n        timeout: '00:00:0000 00:00'\n      }\n    };\n    $.ajax({\n        type: 'PATCH',\n        url: \"/equipment/\"+ id,\n        data: dataEquipment,\n        success: function(repsonse) {\n            console.log(\"Turn off is successfully.\")\n        },\n        error: function(repsonse) {\n          console.log(\"Turn off is fails.\")\n        }\n    })\n  }\n  function autoRequestTurnOn(id){\n    dataEquipment = {\n      equipment:{\n        active: true,\n        timer: '00:00:0000 00:00'\n      }\n    };\n    $.ajax({\n        type: 'PATCH',\n        url: \"/equipment/\"+ id,\n        data: dataEquipment,\n        success: function(repsonse) {\n            console.log(\"Turn off is successfully.\")\n        },\n        error: function(repsonse) {\n          console.log(\"Turn off is fails.\")\n        }\n    })\n  }\n});\n"]},"metadata":{},"sourceType":"module"}